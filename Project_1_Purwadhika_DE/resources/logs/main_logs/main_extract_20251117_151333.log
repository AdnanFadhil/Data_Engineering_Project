[2025-11-17 08:13:36] [INFO] Processing month: 2025-01
[2025-11-17 08:13:36] [INFO] Fetching TLC data page...
[2025-11-17 08:13:38] [INFO] Skipping download (exists): resources/raw/parquet/2025-01/yellow_tripdata_2025-01.parquet
[2025-11-17 08:13:38] [INFO] Skipping download (exists): resources/raw/parquet/2025-01/green_tripdata_2025-01.parquet
[2025-11-17 08:13:38] [INFO] === START NYC Taxi ETL: RAW â†’ CLEAN (2025-01) ===
[2025-11-17 08:13:38] [INFO] Ensured CSV folder exists: resources/raw/csv/yellow/2025-01
[2025-11-17 08:13:39] [INFO] Ensured CSV folder exists: resources/raw/csv/green/2025-01
[2025-11-17 08:13:39] [INFO] Splitting parquet files into daily CSVs...
[2025-11-17 08:13:39] [INFO] Loading parquet files from resources/raw/parquet/2025-01...
[2025-11-17 08:13:39] [INFO] Reading resources/raw/parquet/2025-01/yellow_tripdata_2025-01.parquet ...
[2025-11-17 08:13:39] [INFO] Loaded 3,475,226 rows from yellow_tripdata_2025-01.parquet
[2025-11-17 08:13:39] [INFO] Reading resources/raw/parquet/2025-01/green_tripdata_2025-01.parquet ...
[2025-11-17 08:13:39] [INFO] Loaded 48,326 rows from green_tripdata_2025-01.parquet
[2025-11-17 08:13:45] [INFO] Ensured CSV folder exists: resources/raw/csv/yellow/2025-01
[2025-11-17 08:14:04] [INFO] Saved resources/raw/csv/yellow/2025-01/2024-12-31.csv (21 rows)
[2025-11-17 08:14:05] [INFO] Saved resources/raw/csv/yellow/2025-01/2025-01-01.csv (90,188 rows)
[2025-11-17 08:14:06] [INFO] Saved resources/raw/csv/yellow/2025-01/2025-01-02.csv (84,832 rows)
[2025-11-17 08:14:09] [INFO] Saved resources/raw/csv/yellow/2025-01/2025-01-03.csv (91,250 rows)
[2025-11-17 08:14:11] [INFO] Saved resources/raw/csv/yellow/2025-01/2025-01-04.csv (97,804 rows)
[2025-11-17 08:14:12] [INFO] Saved resources/raw/csv/yellow/2025-01/2025-01-05.csv (79,624 rows)
[2025-11-17 08:14:13] [INFO] Saved resources/raw/csv/yellow/2025-01/2025-01-06.csv (80,126 rows)
[2025-11-17 08:14:15] [INFO] Saved resources/raw/csv/yellow/2025-01/2025-01-07.csv (100,643 rows)
[2025-11-17 08:14:17] [INFO] Saved resources/raw/csv/yellow/2025-01/2025-01-08.csv (113,897 rows)
[2025-11-17 08:14:19] [INFO] Saved resources/raw/csv/yellow/2025-01/2025-01-09.csv (119,285 rows)
[2025-11-17 08:14:21] [INFO] Saved resources/raw/csv/yellow/2025-01/2025-01-10.csv (111,494 rows)
[2025-11-17 08:14:22] [INFO] Saved resources/raw/csv/yellow/2025-01/2025-01-11.csv (121,966 rows)
[2025-11-17 08:14:24] [INFO] Saved resources/raw/csv/yellow/2025-01/2025-01-12.csv (102,510 rows)
[2025-11-17 08:14:26] [INFO] Saved resources/raw/csv/yellow/2025-01/2025-01-13.csv (100,492 rows)
[2025-11-17 08:14:28] [INFO] Saved resources/raw/csv/yellow/2025-01/2025-01-14.csv (121,735 rows)
[2025-11-17 08:14:30] [INFO] Saved resources/raw/csv/yellow/2025-01/2025-01-15.csv (125,359 rows)
[2025-11-17 08:14:32] [INFO] Saved resources/raw/csv/yellow/2025-01/2025-01-16.csv (138,711 rows)
[2025-11-17 08:14:34] [INFO] Saved resources/raw/csv/yellow/2025-01/2025-01-17.csv (120,994 rows)
[2025-11-17 08:14:36] [INFO] Saved resources/raw/csv/yellow/2025-01/2025-01-18.csv (119,812 rows)
[2025-11-17 08:14:38] [INFO] Saved resources/raw/csv/yellow/2025-01/2025-01-19.csv (118,232 rows)
[2025-11-17 08:14:41] [INFO] Saved resources/raw/csv/yellow/2025-01/2025-01-20.csv (90,094 rows)
[2025-11-17 08:14:43] [INFO] Saved resources/raw/csv/yellow/2025-01/2025-01-21.csv (117,592 rows)
[2025-11-17 08:14:45] [INFO] Saved resources/raw/csv/yellow/2025-01/2025-01-22.csv (127,259 rows)
[2025-11-17 08:14:47] [INFO] Saved resources/raw/csv/yellow/2025-01/2025-01-23.csv (138,136 rows)
[2025-11-17 08:14:49] [INFO] Saved resources/raw/csv/yellow/2025-01/2025-01-24.csv (129,546 rows)
[2025-11-17 08:14:51] [INFO] Saved resources/raw/csv/yellow/2025-01/2025-01-25.csv (136,816 rows)
[2025-11-17 08:14:53] [INFO] Saved resources/raw/csv/yellow/2025-01/2025-01-26.csv (102,228 rows)
[2025-11-17 08:14:54] [INFO] Saved resources/raw/csv/yellow/2025-01/2025-01-27.csv (93,060 rows)
[2025-11-17 08:14:56] [INFO] Saved resources/raw/csv/yellow/2025-01/2025-01-28.csv (114,002 rows)
[2025-11-17 08:14:58] [INFO] Saved resources/raw/csv/yellow/2025-01/2025-01-29.csv (120,672 rows)
[2025-11-17 08:15:00] [INFO] Saved resources/raw/csv/yellow/2025-01/2025-01-30.csv (133,266 rows)
[2025-11-17 08:15:02] [INFO] Saved resources/raw/csv/yellow/2025-01/2025-01-31.csv (133,579 rows)
[2025-11-17 08:15:02] [INFO] Saved resources/raw/csv/yellow/2025-01/2025-02-01.csv (1 rows)
[2025-11-17 08:15:03] [INFO] Ensured CSV folder exists: resources/raw/csv/green/2025-01
[2025-11-17 08:15:03] [INFO] Saved resources/raw/csv/green/2025-01/2024-12-25.csv (1 rows)
[2025-11-17 08:15:03] [INFO] Saved resources/raw/csv/green/2025-01/2024-12-29.csv (1 rows)
[2025-11-17 08:15:03] [INFO] Saved resources/raw/csv/green/2025-01/2024-12-31.csv (4 rows)
[2025-11-17 08:15:03] [INFO] Saved resources/raw/csv/green/2025-01/2025-01-01.csv (1,001 rows)
[2025-11-17 08:15:03] [INFO] Saved resources/raw/csv/green/2025-01/2025-01-02.csv (1,516 rows)
[2025-11-17 08:15:03] [INFO] Saved resources/raw/csv/green/2025-01/2025-01-03.csv (1,525 rows)
[2025-11-17 08:15:03] [INFO] Saved resources/raw/csv/green/2025-01/2025-01-04.csv (1,249 rows)
[2025-11-17 08:15:03] [INFO] Saved resources/raw/csv/green/2025-01/2025-01-05.csv (1,129 rows)
[2025-11-17 08:15:03] [INFO] Saved resources/raw/csv/green/2025-01/2025-01-06.csv (1,541 rows)
[2025-11-17 08:15:03] [INFO] Saved resources/raw/csv/green/2025-01/2025-01-07.csv (1,648 rows)
[2025-11-17 08:15:03] [INFO] Saved resources/raw/csv/green/2025-01/2025-01-08.csv (1,680 rows)
[2025-11-17 08:15:03] [INFO] Saved resources/raw/csv/green/2025-01/2025-01-09.csv (1,868 rows)
[2025-11-17 08:15:03] [INFO] Saved resources/raw/csv/green/2025-01/2025-01-10.csv (1,633 rows)
[2025-11-17 08:15:03] [INFO] Saved resources/raw/csv/green/2025-01/2025-01-11.csv (1,296 rows)
[2025-11-17 08:15:03] [INFO] Saved resources/raw/csv/green/2025-01/2025-01-12.csv (1,143 rows)
[2025-11-17 08:15:03] [INFO] Saved resources/raw/csv/green/2025-01/2025-01-13.csv (1,618 rows)
[2025-11-17 08:15:03] [INFO] Saved resources/raw/csv/green/2025-01/2025-01-14.csv (1,775 rows)
[2025-11-17 08:15:03] [INFO] Saved resources/raw/csv/green/2025-01/2025-01-15.csv (1,886 rows)
[2025-11-17 08:15:04] [INFO] Saved resources/raw/csv/green/2025-01/2025-01-16.csv (1,909 rows)
[2025-11-17 08:15:04] [INFO] Saved resources/raw/csv/green/2025-01/2025-01-17.csv (1,810 rows)
[2025-11-17 08:15:04] [INFO] Saved resources/raw/csv/green/2025-01/2025-01-18.csv (1,197 rows)
[2025-11-17 08:15:04] [INFO] Saved resources/raw/csv/green/2025-01/2025-01-19.csv (1,113 rows)
[2025-11-17 08:15:04] [INFO] Saved resources/raw/csv/green/2025-01/2025-01-20.csv (1,084 rows)
[2025-11-17 08:15:04] [INFO] Saved resources/raw/csv/green/2025-01/2025-01-21.csv (1,788 rows)
[2025-11-17 08:15:04] [INFO] Saved resources/raw/csv/green/2025-01/2025-01-22.csv (1,812 rows)
[2025-11-17 08:15:04] [INFO] Saved resources/raw/csv/green/2025-01/2025-01-23.csv (1,849 rows)
[2025-11-17 08:15:04] [INFO] Saved resources/raw/csv/green/2025-01/2025-01-24.csv (1,714 rows)
[2025-11-17 08:15:04] [INFO] Saved resources/raw/csv/green/2025-01/2025-01-25.csv (1,336 rows)
[2025-11-17 08:15:04] [INFO] Saved resources/raw/csv/green/2025-01/2025-01-26.csv (1,308 rows)
[2025-11-17 08:15:04] [INFO] Saved resources/raw/csv/green/2025-01/2025-01-27.csv (1,704 rows)
[2025-11-17 08:15:04] [INFO] Saved resources/raw/csv/green/2025-01/2025-01-28.csv (1,771 rows)
[2025-11-17 08:15:04] [INFO] Saved resources/raw/csv/green/2025-01/2025-01-29.csv (1,748 rows)
[2025-11-17 08:15:04] [INFO] Saved resources/raw/csv/green/2025-01/2025-01-30.csv (1,909 rows)
[2025-11-17 08:15:04] [INFO] Saved resources/raw/csv/green/2025-01/2025-01-31.csv (1,723 rows)
[2025-11-17 08:15:04] [INFO] Saved resources/raw/csv/green/2025-01/2025-02-01.csv (19 rows)
[2025-11-17 08:15:04] [INFO] Saved resources/raw/csv/green/2025-01/2025-02-03.csv (6 rows)
[2025-11-17 08:15:04] [INFO] Saved resources/raw/csv/green/2025-01/2025-02-04.csv (7 rows)
[2025-11-17 08:15:04] [INFO] Saved resources/raw/csv/green/2025-01/2025-02-05.csv (5 rows)
[2025-11-17 08:15:04] [INFO] All daily CSVs generated.
[2025-11-17 08:15:04] [INFO] Uploading CSVs into RAW tables.../app/src/extract_and_load/raw/uploader.py:40: DtypeWarning: Columns (6) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(path)
/app/src/extract_and_load/raw/uploader.py:40: DtypeWarning: Columns (6) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(path)
/app/src/extract_and_load/raw/uploader.py:40: DtypeWarning: Columns (6) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(path)
/app/src/extract_and_load/raw/uploader.py:40: DtypeWarning: Columns (6) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(path)
/app/src/extract_and_load/raw/uploader.py:40: DtypeWarning: Columns (6) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(path)
/app/src/extract_and_load/raw/uploader.py:40: DtypeWarning: Columns (6) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(path)
/app/src/extract_and_load/raw/uploader.py:40: DtypeWarning: Columns (6) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(path)
/app/src/extract_and_load/raw/uploader.py:40: DtypeWarning: Columns (6) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(path)
/app/src/extract_and_load/raw/uploader.py:40: DtypeWarning: Columns (6) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(path)
/app/src/extract_and_load/raw/uploader.py:40: DtypeWarning: Columns (6) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(path)
/app/src/extract_and_load/raw/uploader.py:40: DtypeWarning: Columns (6) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(path)
/app/src/extract_and_load/raw/uploader.py:40: DtypeWarning: Columns (6) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(path)

[2025-11-17 08:15:04] [INFO] Uploading 2024-12-31.csv into table "raw"."yellow_tripdata"
[2025-11-17 08:15:05] [INFO] Skipping 2024-12-31.csv, all rows already inserted based on source_file.
[2025-11-17 08:15:05] [INFO] Uploading 2025-01-01.csv into table "raw"."yellow_tripdata"
[2025-11-17 08:15:05] [INFO] Skipping 2025-01-01.csv, all rows already inserted based on source_file.
[2025-11-17 08:15:05] [INFO] Uploading 2025-01-02.csv into table "raw"."yellow_tripdata"
[2025-11-17 08:15:06] [INFO] Skipping 2025-01-02.csv, all rows already inserted based on source_file.
[2025-11-17 08:15:06] [INFO] Uploading 2025-01-03.csv into table "raw"."yellow_tripdata"
[2025-11-17 08:15:06] [INFO] Skipping 2025-01-03.csv, all rows already inserted based on source_file.
[2025-11-17 08:15:06] [INFO] Uploading 2025-01-04.csv into table "raw"."yellow_tripdata"
[2025-11-17 08:15:06] [INFO] Skipping 2025-01-04.csv, all rows already inserted based on source_file.
[2025-11-17 08:15:06] [INFO] Uploading 2025-01-05.csv into table "raw"."yellow_tripdata"
[2025-11-17 08:15:07] [INFO] Skipping 2025-01-05.csv, all rows already inserted based on source_file.
[2025-11-17 08:15:07] [INFO] Uploading 2025-01-06.csv into table "raw"."yellow_tripdata"
[2025-11-17 08:15:07] [INFO] Skipping 2025-01-06.csv, all rows already inserted based on source_file.
[2025-11-17 08:15:07] [INFO] Uploading 2025-01-07.csv into table "raw"."yellow_tripdata"
[2025-11-17 08:15:07] [INFO] Skipping 2025-01-07.csv, all rows already inserted based on source_file.
[2025-11-17 08:15:07] [INFO] Uploading 2025-01-08.csv into table "raw"."yellow_tripdata"
[2025-11-17 08:15:07] [INFO] Skipping 2025-01-08.csv, all rows already inserted based on source_file.
[2025-11-17 08:15:08] [INFO] Uploading 2025-01-09.csv into table "raw"."yellow_tripdata"
[2025-11-17 08:15:08] [INFO] Skipping 2025-01-09.csv, all rows already inserted based on source_file.
[2025-11-17 08:15:08] [INFO] Uploading 2025-01-10.csv into table "raw"."yellow_tripdata"
[2025-11-17 08:15:08] [INFO] Skipping 2025-01-10.csv, all rows already inserted based on source_file.
[2025-11-17 08:15:08] [INFO] Uploading 2025-01-11.csv into table "raw"."yellow_tripdata"
[2025-11-17 08:15:09] [INFO] Skipping 2025-01-11.csv, all rows already inserted based on source_file.
[2025-11-17 08:15:09] [INFO] Uploading 2025-01-12.csv into table "raw"."yellow_tripdata"
[2025-11-17 08:15:09] [INFO] Skipping 2025-01-12.csv, all rows already inserted based on source_file.
[2025-11-17 08:15:09] [INFO] Uploading 2025-01-13.csv into table "raw"."yellow_tripdata"
[2025-11-17 08:15:09] [INFO] Skipping 2025-01-13.csv, all rows already inserted based on source_file.
[2025-11-17 08:15:09] [INFO] Uploading 2025-01-14.csv into table "raw"."yellow_tripdata"
[2025-11-17 08:15:11] [INFO] Skipping 2025-01-14.csv, all rows already inserted based on source_file.
[2025-11-17 08:15:11] [INFO] Uploading 2025-01-15.csv into table "raw"."yellow_tripdata"
[2025-11-17 08:15:11] [INFO] Skipping 2025-01-15.csv, all rows already inserted based on source_file.
[2025-11-17 08:15:11] [INFO] Uploading 2025-01-16.csv into table "raw"."yellow_tripdata"
[2025-11-17 08:15:12] [INFO] Skipping 2025-01-16.csv, all rows already inserted based on source_file.
[2025-11-17 08:15:12] [INFO] Uploading 2025-01-17.csv into table "raw"."yellow_tripdata"
[2025-11-17 08:15:12] [INFO] Skipping 2025-01-17.csv, all rows already inserted based on source_file.
[2025-11-17 08:15:12] [INFO] Uploading 2025-01-18.csv into table "raw"."yellow_tripdata"
[2025-11-17 08:15:12] [INFO] Skipping 2025-01-18.csv, all rows already inserted based on source_file.
[2025-11-17 08:15:12] [INFO] Uploading 2025-01-19.csv into table "raw"."yellow_tripdata"
[2025-11-17 08:15:13] [INFO] Skipping 2025-01-19.csv, all rows already inserted based on source_file.
[2025-11-17 08:15:13] [INFO] Uploading 2025-01-20.csv into table "raw"."yellow_tripdata"
[2025-11-17 08:15:13] [INFO] Skipping 2025-01-20.csv, all rows already inserted based on source_file.
[2025-11-17 08:15:13] [INFO] Uploading 2025-01-21.csv into table "raw"."yellow_tripdata"
[2025-11-17 08:15:14] [INFO] Skipping 2025-01-21.csv, all rows already inserted based on source_file.
[2025-11-17 08:15:14] [INFO] Uploading 2025-01-22.csv into table "raw"."yellow_tripdata"
[2025-11-17 08:15:14] [INFO] Skipping 2025-01-22.csv, all rows already inserted based on source_file.
[2025-11-17 08:15:14] [INFO] Uploading 2025-01-23.csv into table "raw"."yellow_tripdata"
[2025-11-17 08:15:15] [INFO] Skipping 2025-01-23.csv, all rows already inserted based on source_file.
[2025-11-17 08:15:15] [INFO] Uploading 2025-01-24.csv into table "raw"."yellow_tripdata"
[2025-11-17 08:15:15] [INFO] Skipping 2025-01-24.csv, all rows already inserted based on source_file.
[2025-11-17 08:15:15] [INFO] Uploading 2025-01-25.csv into table "raw"."yellow_tripdata"
[2025-11-17 08:15:15] [INFO] Skipping 2025-01-25.csv, all rows already inserted based on source_file.
[2025-11-17 08:15:15] [INFO] Uploading 2025-01-26.csv into table "raw"."yellow_tripdata"
[2025-11-17 08:15:16] [INFO] Skipping 2025-01-26.csv, all rows already inserted based on source_file.
[2025-11-17 08:15:16] [INFO] Uploading 2025-01-27.csv into table "raw"."yellow_tripdata"
[2025-11-17 08:15:16] [INFO] Skipping 2025-01-27.csv, all rows already inserted based on source_file.
[2025-11-17 08:15:16] [INFO] Uploading 2025-01-28.csv into table "raw"."yellow_tripdata"
[2025-11-17 08:15:17] [INFO] Skipping 2025-01-28.csv, all rows already inserted based on source_file.
[2025-11-17 08:15:17] [INFO] Uploading 2025-01-29.csv into table "raw"."yellow_tripdata"
[2025-11-17 08:15:17] [ERROR] Error inserting 2025-01-29.csv: [Errno 2] No such file or directory: 'resources/raw/csv/yellow/2025-01/2025-01-29.csv'
Traceback (most recent call last):
  File "/app/src/extract_and_load/raw/uploader.py", line 40, in upload_and_archive
    df = pd.read_csv(path)
         ^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1880, in _make_engine
    self.handles = get_handle(
                   ^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/pandas/io/common.py", line 873, in get_handle
    handle = open(
             ^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'resources/raw/csv/yellow/2025-01/2025-01-29.csv'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.12/shutil.py", line 847, in move
    os.rename(src, real_dst)
FileNotFoundError: [Errno 2] No such file or directory: 'resources/raw/csv/yellow/2025-01/2025-01-29.csv' -> 'resources/raw/FAILED/yellow/2025-01/2025-01-29.csv'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/main_extract.py", line 4, in <module>
    Extractor().run_pipeline()
  File "/app/src/extract_and_load/etl_pipeline.py", line 29, in run_pipeline
    uploader.upload_and_archive(cfg, raw_config.engine, month=month_to_process)
  File "/app/src/extract_and_load/raw/uploader.py", line 78, in upload_and_archive
    shutil.move(path, os.path.join(failed_folder, file))
  File "/usr/local/lib/python3.12/shutil.py", line 867, in move
    copy_function(src, real_dst)
  File "/usr/local/lib/python3.12/shutil.py", line 475, in copy2
    copyfile(src, dst, follow_symlinks=follow_symlinks)
  File "/usr/local/lib/python3.12/shutil.py", line 260, in copyfile
    with open(src, 'rb') as fsrc:
         ^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'resources/raw/csv/yellow/2025-01/2025-01-29.csv'
