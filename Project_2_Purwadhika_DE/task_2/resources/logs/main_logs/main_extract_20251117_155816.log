[2025-11-17 08:58:18] [INFO] Processing month: 2025-01
[2025-11-17 08:58:18] [INFO] Fetching TLC data page...
[2025-11-17 08:58:19] [INFO] Skipping download (exists): resources/raw/parquet/2025-01/yellow_tripdata_2025-01.parquet
[2025-11-17 08:58:19] [INFO] Skipping download (exists): resources/raw/parquet/2025-01/green_tripdata_2025-01.parquet
[2025-11-17 08:58:19] [INFO] === START NYC Taxi ETL: RAW â†’ CLEAN (2025-01) ===
[2025-11-17 08:58:19] [INFO] Ensured CSV folder exists: resources/raw/csv/yellow/2025-01
[2025-11-17 08:58:19] [INFO] Ensured CSV folder exists: resources/raw/csv/green/2025-01
[2025-11-17 08:58:19] [INFO] Splitting parquet files into daily CSVs...
[2025-11-17 08:58:19] [INFO] Loading parquet files from resources/raw/parquet/2025-01...
[2025-11-17 08:58:19] [INFO] Reading resources/raw/parquet/2025-01/green_tripdata_2025-01.parquet ...
[2025-11-17 08:58:19] [INFO] Loaded 48,326 rows from green_tripdata_2025-01.parquet
[2025-11-17 08:58:19] [INFO] Reading resources/raw/parquet/2025-01/yellow_tripdata_2025-01.parquet ...
[2025-11-17 08:58:21] [INFO] Loaded 3,475,226 rows from yellow_tripdata_2025-01.parquet
[2025-11-17 08:58:22] [INFO] Ensured CSV folder exists: resources/raw/csv/green/2025-01
[2025-11-17 08:58:22] [INFO] Saved resources/raw/csv/green/2025-01/2025-01-01.csv (1,001 rows)
[2025-11-17 08:58:22] [INFO] Saved resources/raw/csv/green/2025-01/2025-01-02.csv (1,516 rows)
[2025-11-17 08:58:22] [INFO] Saved resources/raw/csv/green/2025-01/2025-01-03.csv (1,525 rows)
[2025-11-17 08:58:22] [INFO] Saved resources/raw/csv/green/2025-01/2025-01-04.csv (1,249 rows)
[2025-11-17 08:58:22] [INFO] Saved resources/raw/csv/green/2025-01/2025-01-05.csv (1,129 rows)
[2025-11-17 08:58:22] [INFO] Saved resources/raw/csv/green/2025-01/2025-01-06.csv (1,541 rows)
[2025-11-17 08:58:22] [INFO] Saved resources/raw/csv/green/2025-01/2025-01-07.csv (1,648 rows)
[2025-11-17 08:58:22] [INFO] Saved resources/raw/csv/green/2025-01/2025-01-08.csv (1,680 rows)
[2025-11-17 08:58:22] [INFO] Saved resources/raw/csv/green/2025-01/2025-01-09.csv (1,868 rows)
[2025-11-17 08:58:22] [INFO] Saved resources/raw/csv/green/2025-01/2025-01-10.csv (1,633 rows)
[2025-11-17 08:58:22] [INFO] Saved resources/raw/csv/green/2025-01/2025-01-11.csv (1,296 rows)
[2025-11-17 08:58:22] [INFO] Saved resources/raw/csv/green/2025-01/2025-01-12.csv (1,143 rows)
[2025-11-17 08:58:22] [INFO] Saved resources/raw/csv/green/2025-01/2025-01-13.csv (1,618 rows)
[2025-11-17 08:58:22] [INFO] Saved resources/raw/csv/green/2025-01/2025-01-14.csv (1,775 rows)
[2025-11-17 08:58:22] [INFO] Saved resources/raw/csv/green/2025-01/2025-01-15.csv (1,886 rows)
[2025-11-17 08:58:23] [INFO] Saved resources/raw/csv/green/2025-01/2025-01-16.csv (1,909 rows)
[2025-11-17 08:58:23] [INFO] Saved resources/raw/csv/green/2025-01/2025-01-17.csv (1,810 rows)
[2025-11-17 08:58:23] [INFO] Saved resources/raw/csv/green/2025-01/2025-01-18.csv (1,197 rows)
[2025-11-17 08:58:23] [INFO] Saved resources/raw/csv/green/2025-01/2025-01-19.csv (1,113 rows)
[2025-11-17 08:58:23] [INFO] Saved resources/raw/csv/green/2025-01/2025-01-20.csv (1,084 rows)
[2025-11-17 08:58:23] [INFO] Saved resources/raw/csv/green/2025-01/2025-01-21.csv (1,788 rows)
[2025-11-17 08:58:23] [INFO] Saved resources/raw/csv/green/2025-01/2025-01-22.csv (1,812 rows)
[2025-11-17 08:58:23] [INFO] Saved resources/raw/csv/green/2025-01/2025-01-23.csv (1,849 rows)
[2025-11-17 08:58:23] [INFO] Saved resources/raw/csv/green/2025-01/2025-01-24.csv (1,714 rows)
[2025-11-17 08:58:23] [INFO] Saved resources/raw/csv/green/2025-01/2025-01-25.csv (1,336 rows)
[2025-11-17 08:58:23] [INFO] Saved resources/raw/csv/green/2025-01/2025-01-26.csv (1,308 rows)
[2025-11-17 08:58:23] [INFO] Saved resources/raw/csv/green/2025-01/2025-01-27.csv (1,704 rows)
[2025-11-17 08:58:23] [INFO] Saved resources/raw/csv/green/2025-01/2025-01-28.csv (1,771 rows)
[2025-11-17 08:58:23] [INFO] Saved resources/raw/csv/green/2025-01/2025-01-29.csv (1,748 rows)
[2025-11-17 08:58:23] [INFO] Saved resources/raw/csv/green/2025-01/2025-01-30.csv (1,909 rows)
[2025-11-17 08:58:23] [INFO] Saved resources/raw/csv/green/2025-01/2025-01-31.csv (1,723 rows)
[2025-11-17 08:58:35] [INFO] Ensured CSV folder exists: resources/raw/csv/yellow/2025-01
[2025-11-17 08:58:38] [INFO] Saved resources/raw/csv/yellow/2025-01/2025-01-01.csv (90,188 rows)
[2025-11-17 08:58:40] [INFO] Saved resources/raw/csv/yellow/2025-01/2025-01-02.csv (84,832 rows)
[2025-11-17 08:58:42] [INFO] Saved resources/raw/csv/yellow/2025-01/2025-01-03.csv (91,250 rows)
[2025-11-17 08:58:44] [INFO] Saved resources/raw/csv/yellow/2025-01/2025-01-04.csv (97,804 rows)
[2025-11-17 08:58:46] [INFO] Saved resources/raw/csv/yellow/2025-01/2025-01-05.csv (79,624 rows)
[2025-11-17 08:58:48] [INFO] Saved resources/raw/csv/yellow/2025-01/2025-01-06.csv (80,126 rows)
[2025-11-17 08:58:52] [INFO] Saved resources/raw/csv/yellow/2025-01/2025-01-07.csv (100,643 rows)
[2025-11-17 08:58:58] [INFO] Saved resources/raw/csv/yellow/2025-01/2025-01-08.csv (113,897 rows)
[2025-11-17 08:59:01] [INFO] Saved resources/raw/csv/yellow/2025-01/2025-01-09.csv (119,285 rows)
[2025-11-17 08:59:05] [INFO] Saved resources/raw/csv/yellow/2025-01/2025-01-10.csv (111,494 rows)
[2025-11-17 08:59:08] [INFO] Saved resources/raw/csv/yellow/2025-01/2025-01-11.csv (121,966 rows)
[2025-11-17 08:59:11] [INFO] Saved resources/raw/csv/yellow/2025-01/2025-01-12.csv (102,510 rows)
[2025-11-17 08:59:13] [INFO] Saved resources/raw/csv/yellow/2025-01/2025-01-13.csv (100,492 rows)
[2025-11-17 08:59:17] [INFO] Saved resources/raw/csv/yellow/2025-01/2025-01-14.csv (121,735 rows)
[2025-11-17 08:59:20] [INFO] Saved resources/raw/csv/yellow/2025-01/2025-01-15.csv (125,359 rows)
[2025-11-17 08:59:23] [INFO] Saved resources/raw/csv/yellow/2025-01/2025-01-16.csv (138,711 rows)
[2025-11-17 08:59:26] [INFO] Saved resources/raw/csv/yellow/2025-01/2025-01-17.csv (120,994 rows)
[2025-11-17 08:59:29] [INFO] Saved resources/raw/csv/yellow/2025-01/2025-01-18.csv (119,812 rows)
[2025-11-17 08:59:32] [INFO] Saved resources/raw/csv/yellow/2025-01/2025-01-19.csv (118,232 rows)
[2025-11-17 08:59:35] [INFO] Saved resources/raw/csv/yellow/2025-01/2025-01-20.csv (90,094 rows)
[2025-11-17 08:59:39] [INFO] Saved resources/raw/csv/yellow/2025-01/2025-01-21.csv (117,592 rows)
[2025-11-17 08:59:43] [INFO] Saved resources/raw/csv/yellow/2025-01/2025-01-22.csv (127,259 rows)
[2025-11-17 08:59:46] [INFO] Saved resources/raw/csv/yellow/2025-01/2025-01-23.csv (138,136 rows)
[2025-11-17 08:59:49] [INFO] Saved resources/raw/csv/yellow/2025-01/2025-01-24.csv (129,546 rows)
[2025-11-17 08:59:54] [INFO] Saved resources/raw/csv/yellow/2025-01/2025-01-25.csv (136,816 rows)
[2025-11-17 08:59:56] [INFO] Saved resources/raw/csv/yellow/2025-01/2025-01-26.csv (102,228 rows)
[2025-11-17 08:59:58] [INFO] Saved resources/raw/csv/yellow/2025-01/2025-01-27.csv (93,060 rows)
[2025-11-17 09:00:01] [INFO] Saved resources/raw/csv/yellow/2025-01/2025-01-28.csv (114,002 rows)
[2025-11-17 09:00:03] [INFO] Saved resources/raw/csv/yellow/2025-01/2025-01-29.csv (120,672 rows)
[2025-11-17 09:00:08] [INFO] Saved resources/raw/csv/yellow/2025-01/2025-01-30.csv (133,266 rows)
[2025-11-17 09:00:11] [INFO] Saved resources/raw/csv/yellow/2025-01/2025-01-31.csv (133,579 rows)
[2025-11-17 09:00:11] [INFO] All daily CSVs generated.
[2025-11-17 09:00:11] [INFO] Uploading CSVs into RAW tables...
[2025-11-17 09:00:11] [INFO] Uploading 2025-01-01.csv into table "raw"."yellow_tripdata"
[2025-11-17 09:00:20] [ERROR] Error inserting 2025-01-01.csv: (psycopg2.errors.UndefinedColumn) column "month" of relation "yellow_tripdata" does not exist
LINE 1: ...rcharge, "Airport_fee", cbd_congestion_fee, date, month, ent...
                                                             ^

[SQL: INSERT INTO raw.yellow_tripdata ("VendorID", tpep_pickup_datetime, tpep_dropoff_datetime, passenger_count, trip_distance, "RatecodeID", store_and_fwd_flag, "PULocationID", "DOLocationID", payment_type, fare_amount, extra, mta_tax, tip_amount, tolls_a ... 561404 characters truncated ... cbd_congestion_fee__999)s, %(date__999)s, %(month__999)s, %(entry_time__999)s, %(source_file__999)s)]
[parameters: {'tpep_pickup_datetime__0': '2025-01-01 00:18:38', 'improvement_surcharge__0': 1.0, 'tpep_dropoff_datetime__0': '2025-01-01 00:26:59', 'RatecodeID__0': 1.0, 'congestion_surcharge__0': 2.5, 'month__0': '2025-01', 'DOLocationID__0': 237, 'Airport_fee__0': 0.0, 'total_amount__0': 18.0, 'trip_distance__0': 1.6, 'payment_type__0': 1, 'tolls_amount__0': 0.0, 'PULocationID__0': 229, 'fare_amount__0': 10.0, 'passenger_count__0': 1.0, 'entry_time__0': datetime.datetime(2025, 11, 17, 9, 0, 15, 814681), 'VendorID__0': 1, 'mta_tax__0': 0.5, 'extra__0': 3.5, 'source_file__0': '2025-01-01.csv', 'date__0': '2025-01-01', 'cbd_congestion_fee__0': 0.0, 'tip_amount__0': 3.0, 'store_and_fwd_flag__0': 'N', 'tpep_pickup_datetime__1': '2025-01-01 00:32:40', 'improvement_surcharge__1': 1.0, 'tpep_dropoff_datetime__1': '2025-01-01 00:35:13', 'RatecodeID__1': 1.0, 'congestion_surcharge__1': 2.5, 'month__1': '2025-01', 'DOLocationID__1': 237, 'Airport_fee__1': 0.0, 'total_amount__1': 12.12, 'trip_distance__1': 0.5, 'payment_type__1': 1, 'tolls_amount__1': 0.0, 'PULocationID__1': 236, 'fare_amount__1': 5.1, 'passenger_count__1': 1.0, 'entry_time__1': datetime.datetime(2025, 11, 17, 9, 0, 15, 814681), 'VendorID__1': 1, 'mta_tax__1': 0.5, 'extra__1': 3.5, 'source_file__1': '2025-01-01.csv', 'date__1': '2025-01-01', 'cbd_congestion_fee__1': 0.0, 'tip_amount__1': 2.02, 'store_and_fwd_flag__1': 'N', 'tpep_pickup_datetime__2': '2025-01-01 00:44:04', 'improvement_surcharge__2': 1.0 ... 23900 parameters truncated ... 'tip_amount__997': 3.28, 'store_and_fwd_flag__997': 'N', 'tpep_pickup_datetime__998': '2025-01-01 00:52:00', 'improvement_surcharge__998': 1.0, 'tpep_dropoff_datetime__998': '2025-01-01 01:13:17', 'RatecodeID__998': 1.0, 'congestion_surcharge__998': 2.5, 'month__998': '2025-01', 'DOLocationID__998': 262, 'Airport_fee__998': 0.0, 'total_amount__998': 36.8, 'trip_distance__998': 6.07, 'payment_type__998': 1, 'tolls_amount__998': 0.0, 'PULocationID__998': 87, 'fare_amount__998': 26.8, 'passenger_count__998': 2.0, 'entry_time__998': datetime.datetime(2025, 11, 17, 9, 0, 15, 814681), 'VendorID__998': 2, 'mta_tax__998': 0.5, 'extra__998': 1.0, 'source_file__998': '2025-01-01.csv', 'date__998': '2025-01-01', 'cbd_congestion_fee__998': 0.0, 'tip_amount__998': 5.0, 'store_and_fwd_flag__998': 'N', 'tpep_pickup_datetime__999': '2025-01-01 00:26:06', 'improvement_surcharge__999': 1.0, 'tpep_dropoff_datetime__999': '2025-01-01 00:37:25', 'RatecodeID__999': 1.0, 'congestion_surcharge__999': 2.5, 'month__999': '2025-01', 'DOLocationID__999': 262, 'Airport_fee__999': 0.0, 'total_amount__999': 17.1, 'trip_distance__999': 2.0, 'payment_type__999': 2, 'tolls_amount__999': 0.0, 'PULocationID__999': 237, 'fare_amount__999': 12.1, 'passenger_count__999': 1.0, 'entry_time__999': datetime.datetime(2025, 11, 17, 9, 0, 15, 814681), 'VendorID__999': 1, 'mta_tax__999': 0.5, 'extra__999': 3.5, 'source_file__999': '2025-01-01.csv', 'date__999': '2025-01-01', 'cbd_congestion_fee__999': 0.0, 'tip_amount__999': 0.0, 'store_and_fwd_flag__999': 'N'}]
(Background on this error at: https://sqlalche.me/e/20/f405)
[2025-11-17 09:00:20] [INFO] Uploading 2025-01-02.csv into table "raw"."yellow_tripdata"
[2025-11-17 09:00:24] [ERROR] Error inserting 2025-01-02.csv: (psycopg2.errors.UndefinedColumn) column "month" of relation "yellow_tripdata" does not exist
LINE 1: ...rcharge, "Airport_fee", cbd_congestion_fee, date, month, ent...
                                                             ^

[SQL: INSERT INTO raw.yellow_tripdata ("VendorID", tpep_pickup_datetime, tpep_dropoff_datetime, passenger_count, trip_distance, "RatecodeID", store_and_fwd_flag, "PULocationID", "DOLocationID", payment_type, fare_amount, extra, mta_tax, tip_amount, tolls_a ... 561404 characters truncated ... cbd_congestion_fee__999)s, %(date__999)s, %(month__999)s, %(entry_time__999)s, %(source_file__999)s)]
[parameters: {'tpep_pickup_datetime__0': '2025-01-02 00:24:09', 'improvement_surcharge__0': 1.0, 'tpep_dropoff_datetime__0': '2025-01-02 00:47:57', 'RatecodeID__0': 1.0, 'congestion_surcharge__0': 2.5, 'month__0': '2025-01', 'DOLocationID__0': 162, 'Airport_fee__0': 1.75, 'total_amount__0': 48.8, 'trip_distance__0': 6.9, 'payment_type__0': 1, 'tolls_amount__0': 0.0, 'PULocationID__0': 70, 'fare_amount__0': 28.9, 'passenger_count__0': 1.0, 'entry_time__0': datetime.datetime(2025, 11, 17, 9, 0, 21, 702276), 'VendorID__0': 1, 'mta_tax__0': 0.5, 'extra__0': 10.25, 'source_file__0': '2025-01-02.csv', 'date__0': '2025-01-02', 'cbd_congestion_fee__0': 0.0, 'tip_amount__0': 8.15, 'store_and_fwd_flag__0': 'N', 'tpep_pickup_datetime__1': '2025-01-02 00:04:39', 'improvement_surcharge__1': 1.0, 'tpep_dropoff_datetime__1': '2025-01-02 00:32:19', 'RatecodeID__1': 1.0, 'congestion_surcharge__1': 2.5, 'month__1': '2025-01', 'DOLocationID__1': 13, 'Airport_fee__1': 1.75, 'total_amount__1': 69.35, 'trip_distance__1': 12.92, 'payment_type__1': 1, 'tolls_amount__1': 0.0, 'PULocationID__1': 138, 'fare_amount__1': 51.3, 'passenger_count__1': 1.0, 'entry_time__1': datetime.datetime(2025, 11, 17, 9, 0, 21, 702276), 'VendorID__1': 2, 'mta_tax__1': 0.5, 'extra__1': 6.0, 'source_file__1': '2025-01-02.csv', 'date__1': '2025-01-02', 'cbd_congestion_fee__1': 0.0, 'tip_amount__1': 6.3, 'store_and_fwd_flag__1': 'N', 'tpep_pickup_datetime__2': '2025-01-02 00:03:27', 'improvement_surcharge__2': 1.0 ... 23900 parameters truncated ... 'tip_amount__997': 0.0, 'store_and_fwd_flag__997': 'N', 'tpep_pickup_datetime__998': '2025-01-02 01:00:04', 'improvement_surcharge__998': 1.0, 'tpep_dropoff_datetime__998': '2025-01-02 01:16:29', 'RatecodeID__998': 1.0, 'congestion_surcharge__998': 2.5, 'month__998': '2025-01', 'DOLocationID__998': 42, 'Airport_fee__998': 0.0, 'total_amount__998': 54.08, 'trip_distance__998': 9.09, 'payment_type__998': 1, 'tolls_amount__998': 0.0, 'PULocationID__998': 163, 'fare_amount__998': 36.6, 'passenger_count__998': 5.0, 'entry_time__998': datetime.datetime(2025, 11, 17, 9, 0, 21, 702276), 'VendorID__998': 2, 'mta_tax__998': 0.5, 'extra__998': 1.0, 'source_file__998': '2025-01-02.csv', 'date__998': '2025-01-02', 'cbd_congestion_fee__998': 0.0, 'tip_amount__998': 12.48, 'store_and_fwd_flag__998': 'N', 'tpep_pickup_datetime__999': '2025-01-02 01:21:56', 'improvement_surcharge__999': 1.0, 'tpep_dropoff_datetime__999': '2025-01-02 01:33:26', 'RatecodeID__999': 1.0, 'congestion_surcharge__999': 0.0, 'month__999': '2025-01', 'DOLocationID__999': 24, 'Airport_fee__999': 0.0, 'total_amount__999': 19.2, 'trip_distance__999': 1.89, 'payment_type__999': 1, 'tolls_amount__999': 0.0, 'PULocationID__999': 42, 'fare_amount__999': 13.5, 'passenger_count__999': 5.0, 'entry_time__999': datetime.datetime(2025, 11, 17, 9, 0, 21, 702276), 'VendorID__999': 2, 'mta_tax__999': 0.5, 'extra__999': 1.0, 'source_file__999': '2025-01-02.csv', 'date__999': '2025-01-02', 'cbd_congestion_fee__999': 0.0, 'tip_amount__999': 3.2, 'store_and_fwd_flag__999': 'N'}]
(Background on this error at: https://sqlalche.me/e/20/f405)
[2025-11-17 09:00:24] [INFO] Uploading 2025-01-03.csv into table "raw"."yellow_tripdata"
[2025-11-17 09:00:28] [ERROR] Error inserting 2025-01-03.csv: (psycopg2.errors.UndefinedColumn) column "month" of relation "yellow_tripdata" does not exist
LINE 1: ...rcharge, "Airport_fee", cbd_congestion_fee, date, month, ent...
                                                             ^

[SQL: INSERT INTO raw.yellow_tripdata ("VendorID", tpep_pickup_datetime, tpep_dropoff_datetime, passenger_count, trip_distance, "RatecodeID", store_and_fwd_flag, "PULocationID", "DOLocationID", payment_type, fare_amount, extra, mta_tax, tip_amount, tolls_a ... 561404 characters truncated ... cbd_congestion_fee__999)s, %(date__999)s, %(month__999)s, %(entry_time__999)s, %(source_file__999)s)]
[parameters: {'tpep_pickup_datetime__0': '2025-01-03 00:03:41', 'improvement_surcharge__0': 1.0, 'tpep_dropoff_datetime__0': '2025-01-03 00:15:12', 'RatecodeID__0': 1.0, 'congestion_surcharge__0': 2.5, 'month__0': '2025-01', 'DOLocationID__0': 230, 'Airport_fee__0': 0.0, 'total_amount__0': 16.4, 'trip_distance__0': 1.33, 'payment_type__0': 2, 'tolls_amount__0': 0.0, 'PULocationID__0': 162, 'fare_amount__0': 11.4, 'passenger_count__0': 1.0, 'entry_time__0': datetime.datetime(2025, 11, 17, 9, 0, 26, 97602), 'VendorID__0': 2, 'mta_tax__0': 0.5, 'extra__0': 1.0, 'source_file__0': '2025-01-03.csv', 'date__0': '2025-01-03', 'cbd_congestion_fee__0': 0.0, 'tip_amount__0': 0.0, 'store_and_fwd_flag__0': 'N', 'tpep_pickup_datetime__1': '2025-01-03 00:03:43', 'improvement_surcharge__1': 1.0, 'tpep_dropoff_datetime__1': '2025-01-03 00:06:42', 'RatecodeID__1': 1.0, 'congestion_surcharge__1': 2.5, 'month__1': '2025-01', 'DOLocationID__1': 48, 'Airport_fee__1': 0.0, 'total_amount__1': 12.96, 'trip_distance__1': 0.71, 'payment_type__1': 1, 'tolls_amount__1': 0.0, 'PULocationID__1': 48, 'fare_amount__1': 5.8, 'passenger_count__1': 5.0, 'entry_time__1': datetime.datetime(2025, 11, 17, 9, 0, 26, 97602), 'VendorID__1': 2, 'mta_tax__1': 0.5, 'extra__1': 1.0, 'source_file__1': '2025-01-03.csv', 'date__1': '2025-01-03', 'cbd_congestion_fee__1': 0.0, 'tip_amount__1': 2.16, 'store_and_fwd_flag__1': 'N', 'tpep_pickup_datetime__2': '2025-01-03 00:12:53', 'improvement_surcharge__2': 1.0 ... 23900 parameters truncated ... 'tip_amount__997': 3.0, 'store_and_fwd_flag__997': 'N', 'tpep_pickup_datetime__998': '2025-01-03 00:07:37', 'improvement_surcharge__998': 1.0, 'tpep_dropoff_datetime__998': '2025-01-03 00:22:48', 'RatecodeID__998': 1.0, 'congestion_surcharge__998': 0.0, 'month__998': '2025-01', 'DOLocationID__998': 38, 'Airport_fee__998': 1.75, 'total_amount__998': 41.95, 'trip_distance__998': 7.79, 'payment_type__998': 1, 'tolls_amount__998': 0.0, 'PULocationID__998': 132, 'fare_amount__998': 31.0, 'passenger_count__998': 1.0, 'entry_time__998': datetime.datetime(2025, 11, 17, 9, 0, 26, 97602), 'VendorID__998': 2, 'mta_tax__998': 0.5, 'extra__998': 1.0, 'source_file__998': '2025-01-03.csv', 'date__998': '2025-01-03', 'cbd_congestion_fee__998': 0.0, 'tip_amount__998': 6.7, 'store_and_fwd_flag__998': 'N', 'tpep_pickup_datetime__999': '2025-01-03 00:11:09', 'improvement_surcharge__999': 1.0, 'tpep_dropoff_datetime__999': '2025-01-03 00:12:16', 'RatecodeID__999': 1.0, 'congestion_surcharge__999': 2.5, 'month__999': '2025-01', 'DOLocationID__999': 237, 'Airport_fee__999': 0.0, 'total_amount__999': 9.4, 'trip_distance__999': 0.41, 'payment_type__999': 2, 'tolls_amount__999': 0.0, 'PULocationID__999': 141, 'fare_amount__999': 4.4, 'passenger_count__999': 1.0, 'entry_time__999': datetime.datetime(2025, 11, 17, 9, 0, 26, 97602), 'VendorID__999': 2, 'mta_tax__999': 0.5, 'extra__999': 1.0, 'source_file__999': '2025-01-03.csv', 'date__999': '2025-01-03', 'cbd_congestion_fee__999': 0.0, 'tip_amount__999': 0.0, 'store_and_fwd_flag__999': 'N'}]
(Background on this error at: https://sqlalche.me/e/20/f405)
[2025-11-17 09:00:28] [INFO] Uploading 2025-01-04.csv into table "raw"."yellow_tripdata"
[2025-11-17 09:00:33] [ERROR] Error inserting 2025-01-04.csv: (psycopg2.errors.UndefinedColumn) column "month" of relation "yellow_tripdata" does not exist
LINE 1: ...rcharge, "Airport_fee", cbd_congestion_fee, date, month, ent...
                                                             ^

[SQL: INSERT INTO raw.yellow_tripdata ("VendorID", tpep_pickup_datetime, tpep_dropoff_datetime, passenger_count, trip_distance, "RatecodeID", store_and_fwd_flag, "PULocationID", "DOLocationID", payment_type, fare_amount, extra, mta_tax, tip_amount, tolls_a ... 561404 characters truncated ... cbd_congestion_fee__999)s, %(date__999)s, %(month__999)s, %(entry_time__999)s, %(source_file__999)s)]
[parameters: {'tpep_pickup_datetime__0': '2025-01-04 00:01:36', 'improvement_surcharge__0': 1.0, 'tpep_dropoff_datetime__0': '2025-01-04 00:21:25', 'RatecodeID__0': 1.0, 'congestion_surcharge__0': 2.5, 'month__0': '2025-01', 'DOLocationID__0': 116, 'Airport_fee__0': 0.0, 'total_amount__0': 39.84, 'trip_distance__0': 6.31, 'payment_type__0': 1, 'tolls_amount__0': 0.0, 'PULocationID__0': 48, 'fare_amount__0': 28.2, 'passenger_count__0': 1.0, 'entry_time__0': datetime.datetime(2025, 11, 17, 9, 0, 30, 40004), 'VendorID__0': 2, 'mta_tax__0': 0.5, 'extra__0': 1.0, 'source_file__0': '2025-01-04.csv', 'date__0': '2025-01-04', 'cbd_congestion_fee__0': 0.0, 'tip_amount__0': 6.64, 'store_and_fwd_flag__0': 'N', 'tpep_pickup_datetime__1': '2025-01-04 00:01:26', 'improvement_surcharge__1': 1.0, 'tpep_dropoff_datetime__1': '2025-01-04 00:23:26', 'RatecodeID__1': 1.0, 'congestion_surcharge__1': 2.5, 'month__1': '2025-01', 'DOLocationID__1': 140, 'Airport_fee__1': 1.75, 'total_amount__1': 38.55, 'trip_distance__1': 6.8, 'payment_type__1': 2, 'tolls_amount__1': 0.0, 'PULocationID__1': 138, 'fare_amount__1': 26.8, 'passenger_count__1': 1.0, 'entry_time__1': datetime.datetime(2025, 11, 17, 9, 0, 30, 40004), 'VendorID__1': 1, 'mta_tax__1': 0.5, 'extra__1': 10.25, 'source_file__1': '2025-01-04.csv', 'date__1': '2025-01-04', 'cbd_congestion_fee__1': 0.0, 'tip_amount__1': 0.0, 'store_and_fwd_flag__1': 'N', 'tpep_pickup_datetime__2': '2025-01-04 00:02:21', 'improvement_surcharge__2': 1.0 ... 23900 parameters truncated ... 'tip_amount__997': 1.36, 'store_and_fwd_flag__997': 'N', 'tpep_pickup_datetime__998': '2025-01-04 00:28:23', 'improvement_surcharge__998': 1.0, 'tpep_dropoff_datetime__998': '2025-01-04 00:37:42', 'RatecodeID__998': 1.0, 'congestion_surcharge__998': 2.5, 'month__998': '2025-01', 'DOLocationID__998': 234, 'Airport_fee__998': 0.0, 'total_amount__998': 16.4, 'trip_distance__998': 1.63, 'payment_type__998': 2, 'tolls_amount__998': 0.0, 'PULocationID__998': 144, 'fare_amount__998': 11.4, 'passenger_count__998': 1.0, 'entry_time__998': datetime.datetime(2025, 11, 17, 9, 0, 30, 40004), 'VendorID__998': 2, 'mta_tax__998': 0.5, 'extra__998': 1.0, 'source_file__998': '2025-01-04.csv', 'date__998': '2025-01-04', 'cbd_congestion_fee__998': 0.0, 'tip_amount__998': 0.0, 'store_and_fwd_flag__998': 'N', 'tpep_pickup_datetime__999': '2025-01-04 00:16:24', 'improvement_surcharge__999': 1.0, 'tpep_dropoff_datetime__999': '2025-01-04 00:23:42', 'RatecodeID__999': 1.0, 'congestion_surcharge__999': 2.5, 'month__999': '2025-01', 'DOLocationID__999': 90, 'Airport_fee__999': 0.0, 'total_amount__999': 17.88, 'trip_distance__999': 1.37, 'payment_type__999': 1, 'tolls_amount__999': 0.0, 'PULocationID__999': 90, 'fare_amount__999': 9.3, 'passenger_count__999': 1.0, 'entry_time__999': datetime.datetime(2025, 11, 17, 9, 0, 30, 40004), 'VendorID__999': 2, 'mta_tax__999': 0.5, 'extra__999': 1.0, 'source_file__999': '2025-01-04.csv', 'date__999': '2025-01-04', 'cbd_congestion_fee__999': 0.0, 'tip_amount__999': 3.58, 'store_and_fwd_flag__999': 'N'}]
(Background on this error at: https://sqlalche.me/e/20/f405)/app/src/extract_and_load/raw/uploader.py:32: DtypeWarning: Columns (6) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(path)
/app/src/extract_and_load/raw/uploader.py:45: DtypeWarning: Columns (6) have mixed types. Specify dtype option on import or set low_memory=False.
  for chunk in pd.read_csv(path, chunksize=chunksize):

[2025-11-17 09:00:33] [INFO] Uploading 2025-01-05.csv into table "raw"."yellow_tripdata"
[2025-11-17 09:00:36] [ERROR] Error inserting 2025-01-05.csv: (psycopg2.errors.UndefinedColumn) column "month" of relation "yellow_tripdata" does not exist
LINE 1: ...rcharge, "Airport_fee", cbd_congestion_fee, date, month, ent...
                                                             ^

[SQL: INSERT INTO raw.yellow_tripdata ("VendorID", tpep_pickup_datetime, tpep_dropoff_datetime, passenger_count, trip_distance, "RatecodeID", store_and_fwd_flag, "PULocationID", "DOLocationID", payment_type, fare_amount, extra, mta_tax, tip_amount, tolls_a ... 561404 characters truncated ... cbd_congestion_fee__999)s, %(date__999)s, %(month__999)s, %(entry_time__999)s, %(source_file__999)s)]
[parameters: {'tpep_pickup_datetime__0': '2025-01-05 00:00:02', 'improvement_surcharge__0': 1.0, 'tpep_dropoff_datetime__0': '2025-01-05 00:17:47', 'RatecodeID__0': 1.0, 'congestion_surcharge__0': 0.0, 'month__0': '2025-01', 'DOLocationID__0': 43, 'Airport_fee__0': 1.75, 'total_amount__0': 64.24, 'trip_distance__0': 8.66, 'payment_type__0': 1, 'tolls_amount__0': 6.94, 'PULocationID__0': 138, 'fare_amount__0': 35.2, 'passenger_count__0': 1.0, 'entry_time__0': datetime.datetime(2025, 11, 17, 9, 0, 34, 710182), 'VendorID__0': 2, 'mta_tax__0': 0.5, 'extra__0': 6.0, 'source_file__0': '2025-01-05.csv', 'date__0': '2025-01-05', 'cbd_congestion_fee__0': 0.0, 'tip_amount__0': 12.85, 'store_and_fwd_flag__0': 'N', 'tpep_pickup_datetime__1': '2025-01-05 00:24:51', 'improvement_surcharge__1': 1.0, 'tpep_dropoff_datetime__1': '2025-01-05 00:50:27', 'RatecodeID__1': 1.0, 'congestion_surcharge__1': 0.0, 'month__1': '2025-01', 'DOLocationID__1': 61, 'Airport_fee__1': 1.75, 'total_amount__1': 60.06, 'trip_distance__1': 9.73, 'payment_type__1': 1, 'tolls_amount__1': 0.0, 'PULocationID__1': 138, 'fare_amount__1': 40.8, 'passenger_count__1': 1.0, 'entry_time__1': datetime.datetime(2025, 11, 17, 9, 0, 34, 710182), 'VendorID__1': 2, 'mta_tax__1': 0.5, 'extra__1': 6.0, 'source_file__1': '2025-01-05.csv', 'date__1': '2025-01-05', 'cbd_congestion_fee__1': 0.0, 'tip_amount__1': 10.01, 'store_and_fwd_flag__1': 'N', 'tpep_pickup_datetime__2': '2025-01-05 00:54:12', 'improvement_surcharge__2': 1.0 ... 23900 parameters truncated ... 'tip_amount__997': 2.87, 'store_and_fwd_flag__997': 'N', 'tpep_pickup_datetime__998': '2025-01-05 00:09:30', 'improvement_surcharge__998': 1.0, 'tpep_dropoff_datetime__998': '2025-01-05 00:21:50', 'RatecodeID__998': 1.0, 'congestion_surcharge__998': 2.5, 'month__998': '2025-01', 'DOLocationID__998': 107, 'Airport_fee__998': 0.0, 'total_amount__998': 19.25, 'trip_distance__998': 1.98, 'payment_type__998': 2, 'tolls_amount__998': 0.0, 'PULocationID__998': 144, 'fare_amount__998': 13.5, 'passenger_count__998': 6.0, 'entry_time__998': datetime.datetime(2025, 11, 17, 9, 0, 34, 710182), 'VendorID__998': 2, 'mta_tax__998': 0.5, 'extra__998': 1.0, 'source_file__998': '2025-01-05.csv', 'date__998': '2025-01-05', 'cbd_congestion_fee__998': 0.75, 'tip_amount__998': 0.0, 'store_and_fwd_flag__998': 'N', 'tpep_pickup_datetime__999': '2025-01-05 00:36:39', 'improvement_surcharge__999': 1.0, 'tpep_dropoff_datetime__999': '2025-01-05 00:48:03', 'RatecodeID__999': 1.0, 'congestion_surcharge__999': 2.5, 'month__999': '2025-01', 'DOLocationID__999': 141, 'Airport_fee__999': 0.0, 'total_amount__999': 25.62, 'trip_distance__999': 3.08, 'payment_type__999': 1, 'tolls_amount__999': 0.0, 'PULocationID__999': 234, 'fare_amount__999': 15.6, 'passenger_count__999': 6.0, 'entry_time__999': datetime.datetime(2025, 11, 17, 9, 0, 34, 710182), 'VendorID__999': 2, 'mta_tax__999': 0.5, 'extra__999': 1.0, 'source_file__999': '2025-01-05.csv', 'date__999': '2025-01-05', 'cbd_congestion_fee__999': 0.75, 'tip_amount__999': 4.27, 'store_and_fwd_flag__999': 'N'}]
(Background on this error at: https://sqlalche.me/e/20/f405)
[2025-11-17 09:00:36] [INFO] Uploading 2025-01-06.csv into table "raw"."yellow_tripdata"
[2025-11-17 09:00:41] [ERROR] Error inserting 2025-01-06.csv: (psycopg2.errors.UndefinedColumn) column "month" of relation "yellow_tripdata" does not exist
LINE 1: ...rcharge, "Airport_fee", cbd_congestion_fee, date, month, ent...
                                                             ^

[SQL: INSERT INTO raw.yellow_tripdata ("VendorID", tpep_pickup_datetime, tpep_dropoff_datetime, passenger_count, trip_distance, "RatecodeID", store_and_fwd_flag, "PULocationID", "DOLocationID", payment_type, fare_amount, extra, mta_tax, tip_amount, tolls_a ... 561404 characters truncated ... cbd_congestion_fee__999)s, %(date__999)s, %(month__999)s, %(entry_time__999)s, %(source_file__999)s)]
[parameters: {'tpep_pickup_datetime__0': '2025-01-06 00:03:13', 'improvement_surcharge__0': 1.0, 'tpep_dropoff_datetime__0': '2025-01-06 00:21:02', 'RatecodeID__0': 1.0, 'congestion_surcharge__0': 2.5, 'month__0': '2025-01', 'DOLocationID__0': 237, 'Airport_fee__0': 1.75, 'total_amount__0': 70.55, 'trip_distance__0': 9.94, 'payment_type__0': 1, 'tolls_amount__0': 6.94, 'PULocationID__0': 70, 'fare_amount__0': 40.1, 'passenger_count__0': 2.0, 'entry_time__0': datetime.datetime(2025, 11, 17, 9, 0, 39, 351286), 'VendorID__0': 2, 'mta_tax__0': 0.5, 'extra__0': 6.0, 'source_file__0': '2025-01-06.csv', 'date__0': '2025-01-06', 'cbd_congestion_fee__0': 0.0, 'tip_amount__0': 11.76, 'store_and_fwd_flag__0': 'N', 'tpep_pickup_datetime__1': '2025-01-06 00:21:50', 'improvement_surcharge__1': 1.0, 'tpep_dropoff_datetime__1': '2025-01-06 00:41:20', 'RatecodeID__1': 1.0, 'congestion_surcharge__1': 2.5, 'month__1': '2025-01', 'DOLocationID__1': 107, 'Airport_fee__1': 1.75, 'total_amount__1': 66.49, 'trip_distance__1': 8.9, 'payment_type__1': 1, 'tolls_amount__1': 6.94, 'PULocationID__1': 138, 'fare_amount__1': 34.5, 'passenger_count__1': 1.0, 'entry_time__1': datetime.datetime(2025, 11, 17, 9, 0, 39, 351286), 'VendorID__1': 1, 'mta_tax__1': 0.5, 'extra__1': 10.25, 'source_file__1': '2025-01-06.csv', 'date__1': '2025-01-06', 'cbd_congestion_fee__1': 0.0, 'tip_amount__1': 13.3, 'store_and_fwd_flag__1': 'N', 'tpep_pickup_datetime__2': '2025-01-06 00:06:52', 'improvement_surcharge__2': 1.0 ... 23900 parameters truncated ... 'tip_amount__997': 12.95, 'store_and_fwd_flag__997': 'N', 'tpep_pickup_datetime__998': '2025-01-06 00:05:08', 'improvement_surcharge__998': 1.0, 'tpep_dropoff_datetime__998': '2025-01-06 00:27:49', 'RatecodeID__998': 1.0, 'congestion_surcharge__998': 2.5, 'month__998': '2025-01', 'DOLocationID__998': 151, 'Airport_fee__998': 0.0, 'total_amount__998': 35.7, 'trip_distance__998': 4.07, 'payment_type__998': 1, 'tolls_amount__998': 0.0, 'PULocationID__998': 186, 'fare_amount__998': 24.0, 'passenger_count__998': 1.0, 'entry_time__998': datetime.datetime(2025, 11, 17, 9, 0, 39, 351286), 'VendorID__998': 2, 'mta_tax__998': 0.5, 'extra__998': 1.0, 'source_file__998': '2025-01-06.csv', 'date__998': '2025-01-06', 'cbd_congestion_fee__998': 0.75, 'tip_amount__998': 5.95, 'store_and_fwd_flag__998': 'N', 'tpep_pickup_datetime__999': '2025-01-06 00:11:07', 'improvement_surcharge__999': 1.0, 'tpep_dropoff_datetime__999': '2025-01-06 00:23:17', 'RatecodeID__999': 1.0, 'congestion_surcharge__999': 0.0, 'month__999': '2025-01', 'DOLocationID__999': 56, 'Airport_fee__999': 0.0, 'total_amount__999': 34.9, 'trip_distance__999': 8.5, 'payment_type__999': 2, 'tolls_amount__999': 0.0, 'PULocationID__999': 132, 'fare_amount__999': 32.4, 'passenger_count__999': 1.0, 'entry_time__999': datetime.datetime(2025, 11, 17, 9, 0, 39, 351286), 'VendorID__999': 1, 'mta_tax__999': 0.5, 'extra__999': 1.0, 'source_file__999': '2025-01-06.csv', 'date__999': '2025-01-06', 'cbd_congestion_fee__999': 0.0, 'tip_amount__999': 0.0, 'store_and_fwd_flag__999': 'N'}]
(Background on this error at: https://sqlalche.me/e/20/f405)
[2025-11-17 09:00:41] [INFO] Uploading 2025-01-07.csv into table "raw"."yellow_tripdata"
[2025-11-17 09:00:44] [ERROR] Error inserting 2025-01-07.csv: (psycopg2.errors.UndefinedColumn) column "month" of relation "yellow_tripdata" does not exist
LINE 1: ...rcharge, "Airport_fee", cbd_congestion_fee, date, month, ent...
                                                             ^

[SQL: INSERT INTO raw.yellow_tripdata ("VendorID", tpep_pickup_datetime, tpep_dropoff_datetime, passenger_count, trip_distance, "RatecodeID", store_and_fwd_flag, "PULocationID", "DOLocationID", payment_type, fare_amount, extra, mta_tax, tip_amount, tolls_a ... 561404 characters truncated ... cbd_congestion_fee__999)s, %(date__999)s, %(month__999)s, %(entry_time__999)s, %(source_file__999)s)]
[parameters: {'tpep_pickup_datetime__0': '2025-01-07 00:00:09', 'improvement_surcharge__0': 1.0, 'tpep_dropoff_datetime__0': '2025-01-07 00:18:36', 'RatecodeID__0': 1.0, 'congestion_surcharge__0': 2.5, 'month__0': '2025-01', 'DOLocationID__0': 79, 'Airport_fee__0': 0.0, 'total_amount__0': 28.35, 'trip_distance__0': 3.6, 'payment_type__0': 2, 'tolls_amount__0': 0.0, 'PULocationID__0': 229, 'fare_amount__0': 22.6, 'passenger_count__0': 1.0, 'entry_time__0': datetime.datetime(2025, 11, 17, 9, 0, 42, 382124), 'VendorID__0': 2, 'mta_tax__0': 0.5, 'extra__0': 1.0, 'source_file__0': '2025-01-07.csv', 'date__0': '2025-01-07', 'cbd_congestion_fee__0': 0.75, 'tip_amount__0': 0.0, 'store_and_fwd_flag__0': 'N', 'tpep_pickup_datetime__1': '2025-01-07 00:21:40', 'improvement_surcharge__1': 1.0, 'tpep_dropoff_datetime__1': '2025-01-07 00:32:03', 'RatecodeID__1': 1.0, 'congestion_surcharge__1': 0.0, 'month__1': '2025-01', 'DOLocationID__1': 7, 'Airport_fee__1': 1.75, 'total_amount__1': 31.94, 'trip_distance__1': 3.3, 'payment_type__1': 1, 'tolls_amount__1': 0.0, 'PULocationID__1': 138, 'fare_amount__1': 16.3, 'passenger_count__1': 1.0, 'entry_time__1': datetime.datetime(2025, 11, 17, 9, 0, 42, 382124), 'VendorID__1': 2, 'mta_tax__1': 0.5, 'extra__1': 6.0, 'source_file__1': '2025-01-07.csv', 'date__1': '2025-01-07', 'cbd_congestion_fee__1': 0.0, 'tip_amount__1': 6.39, 'store_and_fwd_flag__1': 'N', 'tpep_pickup_datetime__2': '2025-01-07 00:23:49', 'improvement_surcharge__2': 1.0 ... 23900 parameters truncated ... 'tip_amount__997': 0.0, 'store_and_fwd_flag__997': 'N', 'tpep_pickup_datetime__998': '2025-01-07 00:18:59', 'improvement_surcharge__998': 1.0, 'tpep_dropoff_datetime__998': '2025-01-07 00:34:32', 'RatecodeID__998': 1.0, 'congestion_surcharge__998': 2.5, 'month__998': '2025-01', 'DOLocationID__998': 244, 'Airport_fee__998': 0.0, 'total_amount__998': 44.94, 'trip_distance__998': 7.79, 'payment_type__998': 1, 'tolls_amount__998': 0.0, 'PULocationID__998': 48, 'fare_amount__998': 31.7, 'passenger_count__998': 1.0, 'entry_time__998': datetime.datetime(2025, 11, 17, 9, 0, 42, 382124), 'VendorID__998': 2, 'mta_tax__998': 0.5, 'extra__998': 1.0, 'source_file__998': '2025-01-07.csv', 'date__998': '2025-01-07', 'cbd_congestion_fee__998': 0.75, 'tip_amount__998': 7.49, 'store_and_fwd_flag__998': 'N', 'tpep_pickup_datetime__999': '2025-01-07 00:31:19', 'improvement_surcharge__999': 1.0, 'tpep_dropoff_datetime__999': '2025-01-07 00:38:32', 'RatecodeID__999': 1.0, 'congestion_surcharge__999': 0.0, 'month__999': '2025-01', 'DOLocationID__999': 129, 'Airport_fee__999': 0.0, 'total_amount__999': 13.2, 'trip_distance__999': 2.0, 'payment_type__999': 2, 'tolls_amount__999': 0.0, 'PULocationID__999': 7, 'fare_amount__999': 10.7, 'passenger_count__999': 1.0, 'entry_time__999': datetime.datetime(2025, 11, 17, 9, 0, 42, 382124), 'VendorID__999': 2, 'mta_tax__999': 0.5, 'extra__999': 1.0, 'source_file__999': '2025-01-07.csv', 'date__999': '2025-01-07', 'cbd_congestion_fee__999': 0.0, 'tip_amount__999': 0.0, 'store_and_fwd_flag__999': 'N'}]
(Background on this error at: https://sqlalche.me/e/20/f405)/app/src/extract_and_load/raw/uploader.py:32: DtypeWarning: Columns (6) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(path)
/app/src/extract_and_load/raw/uploader.py:45: DtypeWarning: Columns (6) have mixed types. Specify dtype option on import or set low_memory=False.
  for chunk in pd.read_csv(path, chunksize=chunksize):

[2025-11-17 09:00:44] [INFO] Uploading 2025-01-08.csv into table "raw"."yellow_tripdata"
[2025-11-17 09:00:48] [ERROR] Error inserting 2025-01-08.csv: (psycopg2.errors.UndefinedColumn) column "month" of relation "yellow_tripdata" does not exist
LINE 1: ...rcharge, "Airport_fee", cbd_congestion_fee, date, month, ent...
                                                             ^

[SQL: INSERT INTO raw.yellow_tripdata ("VendorID", tpep_pickup_datetime, tpep_dropoff_datetime, passenger_count, trip_distance, "RatecodeID", store_and_fwd_flag, "PULocationID", "DOLocationID", payment_type, fare_amount, extra, mta_tax, tip_amount, tolls_a ... 561404 characters truncated ... cbd_congestion_fee__999)s, %(date__999)s, %(month__999)s, %(entry_time__999)s, %(source_file__999)s)]
[parameters: {'tpep_pickup_datetime__0': '2025-01-08 00:16:41', 'improvement_surcharge__0': 1.0, 'tpep_dropoff_datetime__0': '2025-01-08 00:25:23', 'RatecodeID__0': 1.0, 'congestion_surcharge__0': 2.5, 'month__0': '2025-01', 'DOLocationID__0': 211, 'Airport_fee__0': 0.0, 'total_amount__0': 18.9, 'trip_distance__0': 1.16, 'payment_type__0': 1, 'tolls_amount__0': 0.0, 'PULocationID__0': 113, 'fare_amount__0': 10.0, 'passenger_count__0': 1.0, 'entry_time__0': datetime.datetime(2025, 11, 17, 9, 0, 45, 960334), 'VendorID__0': 2, 'mta_tax__0': 0.5, 'extra__0': 1.0, 'source_file__0': '2025-01-08.csv', 'date__0': '2025-01-08', 'cbd_congestion_fee__0': 0.75, 'tip_amount__0': 3.15, 'store_and_fwd_flag__0': 'N', 'tpep_pickup_datetime__1': '2025-01-08 17:19:14', 'improvement_surcharge__1': 1.0, 'tpep_dropoff_datetime__1': '2025-01-08 18:03:47', 'RatecodeID__1': 1.0, 'congestion_surcharge__1': 0.0, 'month__1': '2025-01', 'DOLocationID__1': 145, 'Airport_fee__1': 0.0, 'total_amount__1': 72.05, 'trip_distance__1': 9.64, 'payment_type__1': 1, 'tolls_amount__1': 6.94, 'PULocationID__1': 235, 'fare_amount__1': 50.6, 'passenger_count__1': 1.0, 'entry_time__1': datetime.datetime(2025, 11, 17, 9, 0, 45, 960334), 'VendorID__1': 2, 'mta_tax__1': 0.5, 'extra__1': 1.0, 'source_file__1': '2025-01-08.csv', 'date__1': '2025-01-08', 'cbd_congestion_fee__1': 0.0, 'tip_amount__1': 12.01, 'store_and_fwd_flag__1': 'N', 'tpep_pickup_datetime__2': '2025-01-08 18:08:37', 'improvement_surcharge__2': 1.0 ... 23900 parameters truncated ... 'tip_amount__997': 3.57, 'store_and_fwd_flag__997': 'N', 'tpep_pickup_datetime__998': '2025-01-08 00:02:49', 'improvement_surcharge__998': -1.0, 'tpep_dropoff_datetime__998': '2025-01-08 00:46:43', 'RatecodeID__998': 1.0, 'congestion_surcharge__998': -2.5, 'month__998': '2025-01', 'DOLocationID__998': 89, 'Airport_fee__998': -1.75, 'total_amount__998': -65.1, 'trip_distance__998': 12.79, 'payment_type__998': 4, 'tolls_amount__998': 0.0, 'PULocationID__998': 132, 'fare_amount__998': -57.6, 'passenger_count__998': 1.0, 'entry_time__998': datetime.datetime(2025, 11, 17, 9, 0, 45, 960334), 'VendorID__998': 2, 'mta_tax__998': -0.5, 'extra__998': -1.0, 'source_file__998': '2025-01-08.csv', 'date__998': '2025-01-08', 'cbd_congestion_fee__998': 0.0, 'tip_amount__998': 0.0, 'store_and_fwd_flag__998': 'N', 'tpep_pickup_datetime__999': '2025-01-08 00:02:49', 'improvement_surcharge__999': 1.0, 'tpep_dropoff_datetime__999': '2025-01-08 00:46:43', 'RatecodeID__999': 1.0, 'congestion_surcharge__999': 2.5, 'month__999': '2025-01', 'DOLocationID__999': 89, 'Airport_fee__999': 1.75, 'total_amount__999': 65.1, 'trip_distance__999': 12.79, 'payment_type__999': 4, 'tolls_amount__999': 0.0, 'PULocationID__999': 132, 'fare_amount__999': 57.6, 'passenger_count__999': 1.0, 'entry_time__999': datetime.datetime(2025, 11, 17, 9, 0, 45, 960334), 'VendorID__999': 2, 'mta_tax__999': 0.5, 'extra__999': 1.0, 'source_file__999': '2025-01-08.csv', 'date__999': '2025-01-08', 'cbd_congestion_fee__999': 0.75, 'tip_amount__999': 0.0, 'store_and_fwd_flag__999': 'N'}]
(Background on this error at: https://sqlalche.me/e/20/f405)
[2025-11-17 09:00:48] [INFO] Uploading 2025-01-09.csv into table "raw"."yellow_tripdata"
[2025-11-17 09:00:51] [ERROR] Error inserting 2025-01-09.csv: (psycopg2.errors.UndefinedColumn) column "month" of relation "yellow_tripdata" does not exist
LINE 1: ...rcharge, "Airport_fee", cbd_congestion_fee, date, month, ent...
                                                             ^

[SQL: INSERT INTO raw.yellow_tripdata ("VendorID", tpep_pickup_datetime, tpep_dropoff_datetime, passenger_count, trip_distance, "RatecodeID", store_and_fwd_flag, "PULocationID", "DOLocationID", payment_type, fare_amount, extra, mta_tax, tip_amount, tolls_a ... 561404 characters truncated ... cbd_congestion_fee__999)s, %(date__999)s, %(month__999)s, %(entry_time__999)s, %(source_file__999)s)]
[parameters: {'tpep_pickup_datetime__0': '2025-01-09 00:00:01', 'improvement_surcharge__0': 1.0, 'tpep_dropoff_datetime__0': '2025-01-09 00:27:24', 'RatecodeID__0': 1.0, 'congestion_surcharge__0': 2.5, 'month__0': '2025-01', 'DOLocationID__0': 95, 'Airport_fee__0': 0.0, 'total_amount__0': 64.19, 'trip_distance__0': 9.73, 'payment_type__0': 1, 'tolls_amount__0': 6.94, 'PULocationID__0': 230, 'fare_amount__0': 40.8, 'passenger_count__0': 1.0, 'entry_time__0': datetime.datetime(2025, 11, 17, 9, 0, 49, 491638), 'VendorID__0': 2, 'mta_tax__0': 0.5, 'extra__0': 1.0, 'source_file__0': '2025-01-09.csv', 'date__0': '2025-01-09', 'cbd_congestion_fee__0': 0.75, 'tip_amount__0': 10.7, 'store_and_fwd_flag__0': 'N', 'tpep_pickup_datetime__1': '2025-01-09 00:35:46', 'improvement_surcharge__1': 1.0, 'tpep_dropoff_datetime__1': '2025-01-09 00:45:37', 'RatecodeID__1': 1.0, 'congestion_surcharge__1': 2.5, 'month__1': '2025-01', 'DOLocationID__1': 41, 'Airport_fee__1': 0.0, 'total_amount__1': 20.8, 'trip_distance__1': 2.1, 'payment_type__1': 1, 'tolls_amount__1': 0.0, 'PULocationID__1': 263, 'fare_amount__1': 12.8, 'passenger_count__1': 0.0, 'entry_time__1': datetime.datetime(2025, 11, 17, 9, 0, 49, 491638), 'VendorID__1': 1, 'mta_tax__1': 0.5, 'extra__1': 3.5, 'source_file__1': '2025-01-09.csv', 'date__1': '2025-01-09', 'cbd_congestion_fee__1': 0.0, 'tip_amount__1': 3.0, 'store_and_fwd_flag__1': 'N', 'tpep_pickup_datetime__2': '2025-01-09 00:19:51', 'improvement_surcharge__2': 1.0 ... 23900 parameters truncated ... 'tip_amount__997': 5.67, 'store_and_fwd_flag__997': 'N', 'tpep_pickup_datetime__998': '2025-01-09 00:34:37', 'improvement_surcharge__998': 1.0, 'tpep_dropoff_datetime__998': '2025-01-09 00:56:39', 'RatecodeID__998': 1.0, 'congestion_surcharge__998': 0.0, 'month__998': '2025-01', 'DOLocationID__998': 219, 'Airport_fee__998': 1.75, 'total_amount__998': 63.91, 'trip_distance__998': 10.83, 'payment_type__998': 1, 'tolls_amount__998': 0.0, 'PULocationID__998': 138, 'fare_amount__998': 44.3, 'passenger_count__998': 3.0, 'entry_time__998': datetime.datetime(2025, 11, 17, 9, 0, 49, 491638), 'VendorID__998': 2, 'mta_tax__998': 0.5, 'extra__998': 6.0, 'source_file__998': '2025-01-09.csv', 'date__998': '2025-01-09', 'cbd_congestion_fee__998': 0.0, 'tip_amount__998': 10.36, 'store_and_fwd_flag__998': 'N', 'tpep_pickup_datetime__999': '2025-01-09 00:04:29', 'improvement_surcharge__999': 1.0, 'tpep_dropoff_datetime__999': '2025-01-09 00:09:13', 'RatecodeID__999': 1.0, 'congestion_surcharge__999': 2.5, 'month__999': '2025-01', 'DOLocationID__999': 50, 'Airport_fee__999': 0.0, 'total_amount__999': 15.54, 'trip_distance__999': 1.05, 'payment_type__999': 1, 'tolls_amount__999': 0.0, 'PULocationID__999': 48, 'fare_amount__999': 7.2, 'passenger_count__999': 2.0, 'entry_time__999': datetime.datetime(2025, 11, 17, 9, 0, 49, 491638), 'VendorID__999': 2, 'mta_tax__999': 0.5, 'extra__999': 1.0, 'source_file__999': '2025-01-09.csv', 'date__999': '2025-01-09', 'cbd_congestion_fee__999': 0.75, 'tip_amount__999': 2.59, 'store_and_fwd_flag__999': 'N'}]
(Background on this error at: https://sqlalche.me/e/20/f405)
[2025-11-17 09:00:51] [INFO] Uploading 2025-01-10.csv into table "raw"."yellow_tripdata"
[2025-11-17 09:00:55] [ERROR] Error inserting 2025-01-10.csv: (psycopg2.errors.UndefinedColumn) column "month" of relation "yellow_tripdata" does not exist
LINE 1: ...rcharge, "Airport_fee", cbd_congestion_fee, date, month, ent...
                                                             ^

[SQL: INSERT INTO raw.yellow_tripdata ("VendorID", tpep_pickup_datetime, tpep_dropoff_datetime, passenger_count, trip_distance, "RatecodeID", store_and_fwd_flag, "PULocationID", "DOLocationID", payment_type, fare_amount, extra, mta_tax, tip_amount, tolls_a ... 561404 characters truncated ... cbd_congestion_fee__999)s, %(date__999)s, %(month__999)s, %(entry_time__999)s, %(source_file__999)s)]
[parameters: {'tpep_pickup_datetime__0': '2025-01-10 17:11:15', 'improvement_surcharge__0': 1.0, 'tpep_dropoff_datetime__0': '2025-01-10 17:28:47', 'RatecodeID__0': 1.0, 'congestion_surcharge__0': 2.5, 'month__0': '2025-01', 'DOLocationID__0': 43, 'Airport_fee__0': 0.0, 'total_amount__0': 27.24, 'trip_distance__0': 2.37, 'payment_type__0': 1, 'tolls_amount__0': 0.0, 'PULocationID__0': 24, 'fare_amount__0': 17.7, 'passenger_count__0': 1.0, 'entry_time__0': datetime.datetime(2025, 11, 17, 9, 0, 53, 144725), 'VendorID__0': 2, 'mta_tax__0': 0.5, 'extra__0': 1.0, 'source_file__0': '2025-01-10.csv', 'date__0': '2025-01-10', 'cbd_congestion_fee__0': 0.0, 'tip_amount__0': 4.54, 'store_and_fwd_flag__0': 'N', 'tpep_pickup_datetime__1': '2025-01-10 17:45:01', 'improvement_surcharge__1': 1.0, 'tpep_dropoff_datetime__1': '2025-01-10 17:49:19', 'RatecodeID__1': 1.0, 'congestion_surcharge__1': 0.0, 'month__1': '2025-01', 'DOLocationID__1': 43, 'Airport_fee__1': 0.0, 'total_amount__1': 10.8, 'trip_distance__1': 0.97, 'payment_type__1': 1, 'tolls_amount__1': 0.0, 'PULocationID__1': 151, 'fare_amount__1': 6.5, 'passenger_count__1': 1.0, 'entry_time__1': datetime.datetime(2025, 11, 17, 9, 0, 53, 144725), 'VendorID__1': 2, 'mta_tax__1': 0.5, 'extra__1': 1.0, 'source_file__1': '2025-01-10.csv', 'date__1': '2025-01-10', 'cbd_congestion_fee__1': 0.0, 'tip_amount__1': 1.8, 'store_and_fwd_flag__1': 'N', 'tpep_pickup_datetime__2': '2025-01-10 18:02:11', 'improvement_surcharge__2': 1.0 ... 23900 parameters truncated ... 'tip_amount__997': 2.87, 'store_and_fwd_flag__997': 'N', 'tpep_pickup_datetime__998': '2025-01-10 00:02:32', 'improvement_surcharge__998': 1.0, 'tpep_dropoff_datetime__998': '2025-01-10 00:11:50', 'RatecodeID__998': 1.0, 'congestion_surcharge__998': 2.5, 'month__998': '2025-01', 'DOLocationID__998': 43, 'Airport_fee__998': 0.0, 'total_amount__998': 19.74, 'trip_distance__998': 1.5, 'payment_type__998': 1, 'tolls_amount__998': 0.0, 'PULocationID__998': 229, 'fare_amount__998': 10.7, 'passenger_count__998': 1.0, 'entry_time__998': datetime.datetime(2025, 11, 17, 9, 0, 53, 144725), 'VendorID__998': 2, 'mta_tax__998': 0.5, 'extra__998': 1.0, 'source_file__998': '2025-01-10.csv', 'date__998': '2025-01-10', 'cbd_congestion_fee__998': 0.75, 'tip_amount__998': 3.29, 'store_and_fwd_flag__998': 'N', 'tpep_pickup_datetime__999': '2025-01-10 00:34:51', 'improvement_surcharge__999': 1.0, 'tpep_dropoff_datetime__999': '2025-01-10 00:50:14', 'RatecodeID__999': 1.0, 'congestion_surcharge__999': 0.0, 'month__999': '2025-01', 'DOLocationID__999': 112, 'Airport_fee__999': 1.75, 'total_amount__999': 40.25, 'trip_distance__999': 7.56, 'payment_type__999': 2, 'tolls_amount__999': 0.0, 'PULocationID__999': 138, 'fare_amount__999': 31.0, 'passenger_count__999': 1.0, 'entry_time__999': datetime.datetime(2025, 11, 17, 9, 0, 53, 144725), 'VendorID__999': 2, 'mta_tax__999': 0.5, 'extra__999': 6.0, 'source_file__999': '2025-01-10.csv', 'date__999': '2025-01-10', 'cbd_congestion_fee__999': 0.0, 'tip_amount__999': 0.0, 'store_and_fwd_flag__999': 'N'}]
(Background on this error at: https://sqlalche.me/e/20/f405)